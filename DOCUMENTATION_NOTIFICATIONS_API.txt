ğŸ“‹ DOCUMENTATION API - SYSTÃˆME DE NOTIFICATIONS
=================================================

ï¿½ BASE URL
-----------
https://dio-loto-api.onrender.com

ï¿½ğŸ¯ APERÃ‡U GÃ‰NÃ‰RAL
-----------------
Le systÃ¨me de notifications permet de :
- CrÃ©er automatiquement des notifications lors des transactions
- Consulter les notifications par utilisateur ou globalement
- Marquer les notifications comme lues/non lues
- Supprimer les notifications
- Compter les notifications non lues

ğŸ” AUTHENTIFICATION
-------------------
Toutes les routes nÃ©cessitent un token d'authentification dans le header :
Authorization: Bearer <votre_token>

ğŸ“Š TYPES DE NOTIFICATIONS
-------------------------
- recharge_admin : Recharge effectuÃ©e par un administrateur
- recharge_reseller : Recharge effectuÃ©e par un revendeur
- recharge_user_to_user : Transfert gain â†’ solde principal
- gain_attribue : Attribution de gain Ã  un ticket
- autre : Autres types de notifications

ğŸš€ ROUTES DISPONIBLES
=====================

1ï¸âƒ£ RÃ‰CUPÃ‰RER LES NOTIFICATIONS D'UN UTILISATEUR
-----------------------------------------------
GET https://dio-loto-api.onrender.com/api/notifications/user/:userId

ParamÃ¨tres URL :
- userId (obligatoire) : UUID de l'utilisateur

ParamÃ¨tres Query (optionnels) :
- type : Filtrer par type (recharge_admin, recharge_reseller, etc.)
- limit : Nombre max de notifications (dÃ©faut: 50)
- offset : DÃ©calage pour pagination (dÃ©faut: 0)

Exemples d'appels :
GET https://dio-loto-api.onrender.com/api/notifications/user/uuid-123
GET https://dio-loto-api.onrender.com/api/notifications/user/uuid-123?type=recharge_admin
GET https://dio-loto-api.onrender.com/api/notifications/user/uuid-123?limit=20&offset=10

RÃ©ponse :
{
  "message": "Notifications de l'utilisateur rÃ©cupÃ©rÃ©es avec succÃ¨s.",
  "user": {
    "uniqueUserId": "uuid-123",
    "firstName": "John",
    "lastName": "Doe",
    "email": "john@example.com"
  },
  "pagination": {
    "total": 25,
    "limit": 50,
    "offset": 0,
    "hasMore": false
  },
  "statistics": {
    "recharge_admin": 5,
    "recharge_reseller": 8,
    "gain_attribue": 12
  },
  "notifications": [
    {
      "id": 1,
      "userId": "uuid-123",
      "type": "recharge_admin",
      "title": "Recharge effectuÃ©e par un administrateur",
      "message": "Votre compte a Ã©tÃ© rechargÃ© de 5000 FCFA...",
      "isRead": false,
      "readAt": null,
      "created": "2024-01-15T10:30:00Z"
    }
  ]
}

2ï¸âƒ£ RÃ‰CUPÃ‰RER TOUTES LES NOTIFICATIONS (ADMIN)
---------------------------------------------
GET https://dio-loto-api.onrender.com/api/notifications

ParamÃ¨tres Query (optionnels) :
- type : Filtrer par type
- userId : Filtrer par utilisateur
- dateFrom : Date de dÃ©but (YYYY-MM-DD)
- dateTo : Date de fin (YYYY-MM-DD)
- search : Recherche dans titre/message
- limit : Nombre max (dÃ©faut: 100)
- offset : DÃ©calage (dÃ©faut: 0)

Exemples d'appels :
GET https://dio-loto-api.onrender.com/api/notifications
GET https://dio-loto-api.onrender.com/api/notifications?type=gain_attribue
GET https://dio-loto-api.onrender.com/api/notifications?dateFrom=2024-01-01&dateTo=2024-01-31
GET https://dio-loto-api.onrender.com/api/notifications?search=recharge

RÃ©ponse :
{
  "message": "Toutes les notifications rÃ©cupÃ©rÃ©es avec succÃ¨s.",
  "pagination": { ... },
  "statistics": {
    "byType": {
      "recharge_admin": 450,
      "recharge_reseller": 320
    },
    "byPeriod": {
      "last24hours": 25,
      "last7days": 180,
      "last30days": 650
    }
  },
  "notifications": [ ... ]
}

3ï¸âƒ£ MARQUER UNE NOTIFICATION COMME LUE/NON LUE
---------------------------------------------
PATCH https://dio-loto-api.onrender.com/api/notifications/:id/read

ParamÃ¨tres URL :
- id (obligatoire) : ID de la notification

Body JSON :
{
  "isRead": true  // ou false (optionnel, dÃ©faut: true)
}

Exemple d'appel :
PATCH https://dio-loto-api.onrender.com/api/notifications/123/read
Body: { "isRead": true }

RÃ©ponse :
{
  "message": "Notification marquÃ©e comme lue avec succÃ¨s.",
  "notification": {
    "id": 123,
    "isRead": true,
    "readAt": "2024-01-15T10:30:00Z",
    ...
  }
}

4ï¸âƒ£ MARQUER TOUTES LES NOTIFICATIONS D'UN USER COMME LUES
--------------------------------------------------------
PATCH https://dio-loto-api.onrender.com/api/notifications/user/:userId/mark-all-read

ParamÃ¨tres URL :
- userId (obligatoire) : UUID de l'utilisateur

Exemple d'appel :
PATCH https://dio-loto-api.onrender.com/api/notifications/user/uuid-123/mark-all-read

RÃ©ponse :
{
  "message": "5 notification(s) marquÃ©e(s) comme lue(s) avec succÃ¨s.",
  "user": { ... },
  "statistics": {
    "markedAsRead": 5,
    "totalNotifications": 25
  }
}

5ï¸âƒ£ COMPTER LES NOTIFICATIONS NON LUES
-------------------------------------
GET https://dio-loto-api.onrender.com/api/notifications/user/:userId/unread-count

ParamÃ¨tres URL :
- userId (obligatoire) : UUID de l'utilisateur

Exemple d'appel :
GET https://dio-loto-api.onrender.com/api/notifications/user/uuid-123/unread-count

RÃ©ponse :
{
  "message": "Nombre de notifications non lues rÃ©cupÃ©rÃ© avec succÃ¨s.",
  "user": { ... },
  "unreadCount": 8,
  "unreadByType": {
    "recharge_admin": 3,
    "gain_attribue": 5
  }
}

6ï¸âƒ£ SUPPRIMER UNE NOTIFICATION
-----------------------------
DELETE https://dio-loto-api.onrender.com/api/notifications/:id

ParamÃ¨tres URL :
- id (obligatoire) : ID de la notification

Exemple d'appel :
DELETE https://dio-loto-api.onrender.com/api/notifications/123

RÃ©ponse :
{
  "message": "Notification supprimÃ©e avec succÃ¨s.",
  "deletedNotification": { ... }
}

ğŸ¨ INTÃ‰GRATION FRONTEND - SUGGESTIONS
=====================================

ğŸ’¡ BADGE DE NOTIFICATIONS NON LUES
----------------------------------
Utilisez la route 5ï¸âƒ£ pour afficher un badge avec le nombre de notifications non lues :

// RÃ©cupÃ©rer le count toutes les 30 secondes
setInterval(() => {
  fetch(`https://dio-loto-api.onrender.com/api/notifications/user/${userId}/unread-count`)
    .then(res => res.json())
    .then(data => {
      updateNotificationBadge(data.unreadCount);
    });
}, 30000);

ğŸ’¡ LISTE DES NOTIFICATIONS
--------------------------
Utilisez la route 1ï¸âƒ£ avec pagination pour afficher la liste :

// Charger les notifications avec pagination
function loadNotifications(offset = 0) {
  fetch(`https://dio-loto-api.onrender.com/api/notifications/user/${userId}?limit=20&offset=${offset}`)
    .then(res => res.json())
    .then(data => {
      displayNotifications(data.notifications);
      setupPagination(data.pagination);
    });
}

ğŸ’¡ MARQUER COMME LU AU CLIC
---------------------------
Utilisez la route 3ï¸âƒ£ quand l'utilisateur clique sur une notification :

function markAsRead(notificationId) {
  fetch(`https://dio-loto-api.onrender.com/api/notifications/${notificationId}/read`, {
    method: 'PATCH',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ isRead: true })
  })
  .then(() => {
    // Mettre Ã  jour l'interface
    updateNotificationUI(notificationId);
  });
}

ğŸ’¡ BOUTON "TOUT MARQUER COMME LU"
---------------------------------
Utilisez la route 4ï¸âƒ£ pour un bouton "Marquer tout comme lu" :

function markAllAsRead() {
  fetch(`https://dio-loto-api.onrender.com/api/notifications/user/${userId}/mark-all-read`, {
    method: 'PATCH'
  })
  .then(res => res.json())
  .then(data => {
    showMessage(`${data.statistics.markedAsRead} notifications marquÃ©es comme lues`);
    refreshNotificationsList();
  });
}

ğŸ”„ CRÃ‰ATION AUTOMATIQUE
=======================
Les notifications sont crÃ©Ã©es automatiquement lors de :
- Recharge admin â†’ revendeur
- Recharge admin â†’ utilisateur
- Recharge revendeur â†’ utilisateur
- Attribution de gain Ã  un ticket
- Transfert gain â†’ solde principal

Aucune action frontend nÃ©cessaire pour la crÃ©ation !

ğŸ“± RECOMMANDATIONS UX
=====================
1. Afficher un badge avec le nombre de notifications non lues
2. Marquer automatiquement comme lu quand l'utilisateur clique
3. Proposer un bouton "Tout marquer comme lu"
4. Utiliser la pagination pour les grandes listes
5. Actualiser le count pÃ©riodiquement (toutes les 30s)
6. DiffÃ©rencier visuellement les notifications lues/non lues

ğŸš¨ GESTION D'ERREURS
====================
Toutes les routes retournent des codes HTTP standards :
- 200 : SuccÃ¨s
- 400 : ParamÃ¨tres manquants/invalides
- 404 : Ressource non trouvÃ©e
- 500 : Erreur serveur

Exemple de gestion d'erreur :
fetch('https://dio-loto-api.onrender.com/api/notifications/user/invalid-id')
  .then(res => {
    if (!res.ok) {
      throw new Error(`HTTP ${res.status}`);
    }
    return res.json();
  })
  .catch(err => {
    console.error('Erreur notifications:', err);
  });
